# Stm-loader

Рабочий проект загрузчика микроконтроллера STM32f407. Предназначен для настройки микроконтроллера, проверки работоспособности периферии и загрузки hex-файлов в ОЗУ.

## Блок схема

```mermaid
flowchart TD
    classDef default font-size:20px,font-weight:bold
    
    A["Старт программы"] --> B["Настройка микроконтроллера"]
    B --> C{"Команда КТА подана?"}

    C -->|Да| D["Технологический режим"]
    C -->|Нет| E{"Первое включение?"}

    
    E -->|Нет| F["Переход к пользовательской программе в ПЗУ"]
    E -->|Да| G["Последовательное тестирование оборудования"]
    
    D --> H{"Ожидание команды"}
    H -->|"Версия"| I["Вывод информации о загрузчике"]
    H -->|"Загрузка"| J["Прием HEX файла по RS232 и запись в ОЗУ"]
    H -->|"Запуск"| K["Передача управления программе в ОЗУ"]
    H -->|"Справка"| L["Вывод списка команд"]
    I --> H
    J --> H
    L --> H
    K --> Z["Завершение работы"]
    
    G --> M["Тест ОЗУ(Вывод результата)"]
    M --> N["Тест ПЗУ(Вывод результата)"]
    N --> O["Тест GPIO(Вывод результата)"]
    O --> U["Тест АЦП(Вывод результата)"]
    U --> P["Тест WDT(Вывод результата)"]
    
    P --> R["Перезагрузка МК"]
    R --> A
    F --> Z["Завершение работы"]
    %% Стили для стрелок (0-3 это номера соединений Да/Нет)
    linkStyle 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21 stroke-width:2px,font-size:30px
```
<br>

### Режимы работы
Загрузчик имеет два режима работы. Технологически и основной. В технологическом режиме загрузчик принимает команды по UART, с помощью которых он может загружать hex-файлы в ОЗУ и передават им управление. В основном режиме загрузчик осуществляет настройку самого микроконтроллера и проверяет работу периферии. После всех проверок управление передается пользовательской(бортовой) программе.

## Используемые инструменты

- OC: Windows
- компилятор: arm compiller 5
- стандарт языка: С99
- отладчик: интегрированный в Keil µVision 5
- терминальная программа: Putty или Tera Term
